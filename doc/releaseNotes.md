# fspClientLib  Release Notes

> **代码开源地址：**https://github.com/omapi/fspClientLib

## fspClientLib 0.12_V11  ReleaseNotes 2016-11-11  by ywhou
#### 改进
| 功能描述                                     | 注意事项 | 关注人     |
| ---------------------------------------- | ---- | ------- |
| 改进超时处理机制，如果第1次警告，包大小退到之前传输速度最大用的包大小，并停止包调整策略；如果第2次警告，就把包大小退到1024。如果第3次警告，就直接调整到最小值|  |dmzhang|
|发送超时时间由5 minutes改成1minutes，最大接收时延由1 minutes改成30s|可以有效改进程序等待时间|dmzhang|
|错误和警告信息前增加换行符|解决出现了“[1A[K”的情况|dmzhang|

## fspClientLib 0.12_V10  ReleaseNotes 2016-10-18  by xxfan
#### 改进
| 功能描述                                     | 注意事项 | 关注人     |
| ---------------------------------------- | ---- | ------- |
| 改进传输包大小自适应机制| 该版本需要回归测试|dmzhang|
| 改进下载进度输出方式| |dmzhang|
| 增加最大和最小传输包限制参数-min -max| |dmzhang|
| 更新p2p库为1.1.10| |dmzhang|


## fspClientLib 0.12_V9  ReleaseNotes 2016-09-09  by xxfan

#### 修复

| 问题描述                                     | 注意事项 | 关注人     |
| ---------------------------------------- | ---- | ------- |
| 1. 修改：查询目录的数据包大小固定为768,否则可能出现获取的文件数目小于实际情况                 |      | dmzhang |
| 2. 修改：下载包大小自适应策略调整。1) 一个文件被分割成大小为x的n等份进行传输；2)x的大小由之前的传输情况决定，每丢包一次，x减100，超时一次x除以2，每连续1000次未丢包，x乘以1.5  x最小为512.最大为147080 |      | dmzhang |
| 3. 修复：查询的目录如果不存在，出现段错误                   |      | dmzhang |
#### 新增
| 功能描述                                     | 注意事项 | 关注人     |
| ---------------------------------------- | ---- | ------- |
| 1. 新增参数-d(--debug),值为yes／no.值为yes时,程序运行目录下会生成p2p约会过程的日志文件，no时不写日志文件，默认值为no |      | dmzhang |


## fspClientLib 0.12_V8 ReleaseNotes 2016-08-25  by xxfan

#### 修复

| 问题描述                 | 注意事项 | 关注人     |
| -------------------- | ---- | ------- |
| 1. -ps指定的值，在查询目录时未生效 |      | dmzhang |

#### 改进

| 功能描述                                     | 注意事项                                    | 关注人     |
| ---------------------------------------- | --------------------------------------- | ------- |
| 1.当网络带宽小或状态差时，如果服务器传输给客户端的包过大时，可能会导致客户端收不到消息。现改进为，当客户端等待超时后，会告诉服务器减小传输的包的大小，第一次缩小到1024，如果依然超时再缩小到768，两次都失败则退出。 | 超时后有警告消息：Warning，code＝100，reason＝“…...” | dmzhang |
| 2. 改进查询文件夹的输出结果，在起始和结束分隔符\[start\]和\[end\]之间打印文件列表 |                                         | dmzhang |





## fspClientLib 0.12_V7  ReleaseNotes 2016-08-17  by xxfan

### 改进

| 功能描述                                     | 注意事项                                     | 关注人     |
| ---------------------------------------- | ---------------------------------------- | ------- |
| 1. 支持可指定服务器发给客户端的包大小，参数-ps ，单位byte，默认7348，最大14708 | 1. 需要和fspd 1.0.5＋版本配合；2. 当ps值大于服务器设置的packet_size时，传输包大小会采用服务器配置的packet_size | dmzhang |
| 2. 打印p2p约会耗时和下载文件的耗时                     |                                          | dmzhang |



## fspClientLib 0.12_V6  ReleaseNotes 2016-08-10  by xxfan

### 改进

| 功能描述                                     | 注意事项 | 关注人     |
| ---------------------------------------- | ---- | ------- |
| 1. 错误码格式统一为“Failed,code=X,reason="YYYYY" |      | dmzhang |
| 2. 下载文件夹时，如果文件在本地已经存在且完整，则不重复下载          |      | dmzhang |
| 3. 增加p2p注册超时判断，如果注册超时则退出程序，防止死循环         |      | dmzhang |

###

## fspClientLib 0.12_V5  ReleaseNotes 2016-06-27  by xxfan

### 改进

| 功能描述         | 注意事项                           | 关注人     |
| ------------ | ------------------------------ | ------- |
| 完善操作失败时的错误提示 | 如：下载文件不存在，密码错误，文件创建失败，p2p连接失败等 | dmzhang |

### bug修复

| 问题描述                          | 解决方法        | 关注人     |
| ----------------------------- | ----------- | ------- |
| 1. 当要下载的目录有子目录时，会把子目录当文件处理    | 忽略子目录，只下载文件 | dmzhang |
| 2. 下载文件失败时，依然会创建大小为0的文件       | 下载失败删除创建的文件 | dmzhang |
| 3.  下载指定文件夹无写的权限时，下载失败，无相关的提示 | 增加错误提示      | dmzhang |



## fspClientLib 0.12_V4  ReleaseNotes 2016-06-23  by xxfan

### 新功能

| 功能描述           | 使用方法                      | 注意事项                      | 关注人员    |
| -------------- | ------------------------- | ------------------------- | ------- |
| 1. 新增p2p约会的邀请码 | ./fspClientDemo -ic 邀请码内容 | OM的FSP服务默认邀请码为newrocktech | dmzhang |

### 修改

| 功能描述           | 使用方法 | 注意事项 | 关注人  |
| -------------- | ---- | ---- | ---- |
| 更新p2p库版本为1.1.4 |      |      |      |



## fspClientLib 0.12_V3  ReleaseNotes 2016-06-21  by xxfan

- ##### 新功能和改进

| 功能描述              | 使用方法                                     | 注意事项                                  | 关注人员    |
| ----------------- | ---------------------------------------- | ------------------------------------- | ------- |
| 1. 传参改进           | ./fspClientDome —help                    | 参数名和参数值之间要有空格                         | dmzhang |
| 2. 查询文件夹下的文件列表详情  | ./fspClientDome  -id *设备id* -p *设备密码* -ls *文件夹名称* | 默认密码为newrocktech                      | dmzhang |
| 3. 下载整个文件夹        | ./fspClientDome -id *设备id* -p *设备密码* -g *文件夹名称*  [-s *本地保存路径*] | 1. 文件夹名称必须以斜杠结尾；2. 指定本地保存路径时，保存到当前目录下 | dmzhang |
| 4. 下载文件时可指定本地保存路径 | ./fspClientDome -id *设备id* -p *设备密码* -g *文件名称*  [-s *本地保存路径*] | 未指定保持路径时，保存在当下目录下                     | dmzhang |



## fspClientLib 0.12_V2  ReleaseNotes  2016-06-07  by xxfan



- 更新：更新p2pnat的库(1.1.3)，以及相关的调用接口；
- 新增： 支持获取文件的URL带有目录；
